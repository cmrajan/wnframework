<html>
<head>
<style>
html, body {
	font-family: Arial;
	font-size: 11px;
}
</style>

 <!-- janak <script type="text/javascript" src="http://maps.google.com/maps?file=api&v=2&key=ABQIAAAAKtq-HASlqu0SAkgKVI0VRRSbiu_SzPrCDX9K1d1eDhFado1_-BTfHNy3kfOc58XE3TVLIkW0N4BPkQ"></script> -->
 <!-- 72.55.168.105 -->
 <script type="text/javascript" src="http://maps.google.com/maps?file=api&v=2&key=ABQIAAAAb5Fp9O4oYnVN_9_vFET5XRRTRQ7dDLW4aL6nzQ2Sr_F-LB2n6xSDinHFZ5-t-530uGso716O2RprPA"></script>
 <script type="text/javascript" src="http://www.google.com/uds/api?file=uds.js&v=1.0"></script>

</head>
<body>
	<div style="width: 600px;">
	  <div id='gmap_div' style="width: 100%; height: 400px; border: 1px solid #444;">
	Loading...
	  </div>
	</div>
	<div id='gmap_search_box' style="width: 600px; display: none;">
	
	</div>
	
<script type='text/javascript'>

// GOOGLE MAPS API

function $i(id) { if(!id) return null; if(id && id.appendChild)return id; return document.getElementById(id); }

var gmap_data; var gmap_idx=0;

function GMapApp(div_ele) {

	this.baseIcon = new GIcon();

	this.baseIcon.shadow = "http://www.google.com/mapfiles/shadow50.png";
	this.baseIcon.iconSize = new GSize(20, 34);
	this.baseIcon.shadowSize = new GSize(37, 34);
	this.baseIcon.iconAnchor = new GPoint(9, 34);
	this.baseIcon.infoWindowAnchor = new GPoint(9, 2);
	this.baseIcon.infoShadowAnchor = new GPoint(18, 25);

	this.myMap = null;
	this.markerList = new Array();

    // create a map
	this.myMap = new GMap2(div_ele);
	this.myMap.addControl(new GLargeMapControl());
	this.myMap.addControl(new GMapTypeControl());
	this.myMap.setCenter(new GLatLng(22.100000,78.962880), 4);

	// Create a search control
	var searchControl = new GSearchControl();

	// Add in a full set of searchers
	var localSearch = new GlocalSearch();
	searchControl.addSearcher(localSearch);

	// Set the Local Search center point
	localSearch.setCenterPoint(this.myMap);

	// tell the searcher to draw itself and tell it where to attach
    searchControl.draw($i('gmap_search_box'));

	this.sc = searchControl
	
	// execute an inital search
	gmap_idx=0;
	gmap_do_search(this);
}

function gmap_do_search(app) {
	if(gmap_idx > gmap_data.length) {
		return;
	}
	app.sc.setSearchCompleteCallback(app, app.OnSearchComplete);
	app.sc.execute(gmap_data[gmap_idx].name);
}

GMapApp.prototype.OnSearchComplete = function(sc, searcher) {
	//alert("OnSearchComplete")
	// if we have local search results, put them on the map
	if ( searcher.results && searcher.results.length > 0) {
		for (var i = 0; i < searcher.results.length; i++) {
			var result = searcher.results[i];

			// if this is a local search result, then proceed...
			if (result.GsearchResultClass == GlocalSearch.RESULT_CLASS ) {
				var markerObject = new Object();
				var letteredIcon = new GIcon(this.baseIcon);

				// here add codition to define color of ballon
				letteredIcon.image = "http://labs.google.com/ridefinder/images/mm_20_"+gmap_data[gmap_idx].color+".png"
				markerOptions = { icon:letteredIcon };

				markerObject.result = result;
				markerObject.contain = gmap_data[gmap_idx].box_html;

				markerObject.latLng = new GLatLng(parseFloat(result.lat), parseFloat(result.lng));

				markerObject.gmarker = new GMarker(markerObject.latLng,markerOptions);
				var clickHandler = method_closure(this, this.OnMarkerClick, [markerObject]);
				
				GEvent.bind(markerObject.gmarker, "click", this, clickHandler);
				this.markerList.push(markerObject);
				this.myMap.addOverlay(markerObject.gmarker);
				result.__markerObject__ = markerObject;
			}
		}
		if(gmap_idx==0)this.OnMarkerClick(this.markerList[0]);
	}
	gmap_idx +=1;
	gmap_do_search(this);
}

GMapApp.prototype.OnMarkerClick = function(markerObject) {
	//alert("OnMarkerClick")
	this.myMap.closeInfoWindow();
	markerObject.gmarker.openInfoWindowHtml(markerObject.contain);
}

function method_closure(object, method, opt_argArray) {
	return function() {
		return method.apply(object, opt_argArray);
	}
}

window.parent.pscript.gmap_show();
</script>
</body>
</html>